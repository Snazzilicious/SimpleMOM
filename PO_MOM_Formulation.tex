\documentclass{article}

\usepackage[a4paper, total={6in, 8in}]{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{indentfirst}
\usepackage{hyperref}

\usepackage{algorithm}
\usepackage{algpseudocode}

\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
\newcommand{\abs}[1]{\left\lvert #1 \right\rvert}
\newcommand{\Div}[0]{\nabla\cdot}
\newcommand{\Curl}[0]{\nabla\times}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Lemma}

\theoremstyle{plain}
\newtheorem*{remark}{Remark}

\title{Solution of MOM Impedance Matrix by Sparse Matrix Factorization}
\author{Ian Holloway}
\date{December 2023}

\begin{document}
\maketitle

\section{Introduction}\label{sec_intro}

Consider an infinite plane wave incident on an infinite planar PEC surface.
The currents induced may be computed by solving the EFIE problem
\begin{equation}
	-\hat{n}\times\mathbf{E}_i(x) = \hat{n}\times\int_\Omega \frac{e^{-ikR}}{4\pi R}
	\left( i\omega\mu_0\mathbf{J} 
	+ \frac{1}{i\omega\epsilon_0}\left( ik + \frac{1}{R} \right) \hat{R} (\nabla\cdot\mathbf{J}) \right) \,dx',
\end{equation}
\begin{equation}
	R = \norm{x-x'}.
\end{equation}
% Plug in plane wave for E and J
The incident plane wave is given by
\begin{equation}
	\mathbf{E}_i = \mathbf{A}_Ee^{-i(\mathbf{b}_E\cdot x + c_E)}.
\end{equation}
% TODO expression for E_i on/at the surface - Assume normal to plane is zHat
We propose that the current also takes the form of a plane wave
\begin{equation}
	\mathbf{J} = \mathbf{A}_Je^{-i(\mathbf{b}_J\cdot x + c_J)}.
\end{equation}
Computing the integral will allow us to fill in the values of $A_J$, $b_J$, and $c_J$.
The explicit integral is
\begin{equation}
	-\hat{n}\times\mathbf{A}_Ee^{-i(\mathbf{b}_E\cdot x + c_E)}
	= \hat{n}\times\int_\Omega \frac{e^{-i(kR+\mathbf{b}_J\cdot x' + c_J)}}{4\pi R}
	\left( i\omega\mu_0 \mathbf{A}_J
	- \frac{(\mathbf{A}_J\cdot\mathbf{b})}{\omega\epsilon_0}\left( ik + \frac{1}{R} \right) \hat{R} \right) \,dx',
\end{equation}
% integrate both terms - get your Bessel Functions ready
It is helpful to convert to a polar coordinate system given by
\begin{equation}
	x'_1-x_1 = r\cos{\theta} \text{ and } x'_2-x_2 = r\sin{\theta}, \quad\text{or}\quad r = R \text{ and } \theta = \tan^{-1}{\frac{x'_2 - x_2}{x'_1 - x_1}}.
\end{equation}
We now have the integral
\begin{equation}
	\int_0^\infty \int_0^{2\pi} \frac{e^{-i(kr+\norm{\mathbf{b}_J}r\cos{\theta} + \mathbf{b}_J\cdot x + c_J)}}{4\pi r}
	\left( i\omega\mu_0 \mathbf{A}_J
	+ \frac{(\mathbf{A}_J\cdot\mathbf{b})}{\omega\epsilon_0}\left( ik + \frac{1}{r} \right) <\cos{\theta},\sin{\theta}> \right) \,rd\theta dr,
\end{equation}
\begin{multline}
	=i\omega\mu_0 \mathbf{A}_J\frac{e^{-i(\mathbf{b}_J\cdot x + c_J)}}{4\pi}
	\int_0^\infty e^{-ikr} \int_0^{2\pi} e^{-i\norm{\mathbf{b}_J}r\cos{\theta}} \,d\theta dr \\
	+ \frac{k}{\omega\epsilon_0}(\mathbf{A}_J\cdot\mathbf{b})\frac{e^{-i(\mathbf{b}_J\cdot x + c_J)}}{4\pi}
	\int_0^\infty e^{-ikr}\left( ik + \frac{1}{r} \right) \int_0^{2\pi} e^{-i\norm{\mathbf{b}_J}r\cos{\theta}} <\cos{\theta},\sin{\theta}> \,d\theta dr.
\end{multline}
An important identity for computing this is
\begin{equation}
	e^{-i\alpha\cos{\beta}}
	= J_0(\alpha) + 2\sum_{\nu=1}^\infty (-1)^\nu J_{2\nu}(\alpha)\cos{2\nu\beta} 
	- 2i\sum_{\nu=0}^\infty (-1)^\nu J_{2\nu+1}(\alpha)\cos{\left((2\nu+1)\beta\right)},
\end{equation}
where $J_\nu$ is the Bessel function of the first kind of order $\nu$.
We thus get
\begin{equation}
	\int_0^{2\pi} e^{-i\norm{\mathbf{b}_J}r\cos{\theta}} \,d\theta = 2\pi J_0(\norm{\mathbf{b}_J}r)
\end{equation}
and
\begin{equation}
	\int_0^{2\pi} e^{-i\norm{\mathbf{b}_J}r\cos{\theta}} <\cos{\theta},\sin{\theta}> \,d\theta = <0,0>.
\end{equation}
The integral is now
\begin{equation}
	=i\omega\mu_0 \mathbf{A}_J\frac{e^{-i(\mathbf{b}_J\cdot x + c_J)}}{2}
	\int_0^\infty e^{-ikr} J_0(\norm{\mathbf{b}_J}r) dr
\end{equation}
\begin{equation}
	= \frac{\omega\mu_0\norm{\mathbf{b}_J}^2}{2\left(k^2 - \norm{\mathbf{b}_J}^2\right)} \mathbf{A}_J e^{-i(\mathbf{b}_J\cdot x + c_J)}.
\end{equation}
% solve for J plane wave parameters
We can now solve
\begin{equation}
	-\hat{n}\times\mathbf{A}_E e^{-i(\mathbf{b}_E\cdot x + c_E)}
	= \hat{n}\times\frac{\omega\mu_0\norm{\mathbf{b}_J}^2}{2\left(k^2 - \norm{\mathbf{b}_J}^2\right)} \mathbf{A}_J e^{-i(\mathbf{b}_J\cdot x + c_J)}
\end{equation}
by setting
\begin{equation}
	\mathbf{A}_J = \pm \frac{2\left(k^2 - \norm{\mathbf{b}_J}^2\right)}{\omega\mu_0\norm{\mathbf{b}_J}^2} \hat{n}\times( \hat{n}\times\mathbf{A}_E ),
	\quad\quad \mathbf{b}_J = \mathbf{b}_E,
	\quad\text{and}\quad c_J = c_E
\end{equation}
% TODO get sign right for A AND update expression for b

% compute field at a distance
The electric field induced by this current function is 
\begin{equation}
	E_s(x)
	= \int_\Omega \frac{e^{-i(kR+\mathbf{b}_J\cdot x' + c_J)}}{4\pi R}
	\left( i\omega\mu_0 \mathbf{A}_J
	+ \frac{k}{\omega\epsilon_0}\left( ik + \frac{1}{R} \right)(\mathbf{A}_J\cdot\mathbf{b}) \hat{R} \right) \,dx',
\end{equation}
For positions $x$ off the scattering plane, 

% set h to be a large number



% coordinate change


% stationary phase












\end{document}
